// === АНИМЕ-ХАКЕРСКИЙ ШЕЙДЕР 2025 ===

float Time         : register(c0);    // время в секундах (будем передавать из C#)
float Intensity    : register(c1);    // сила эффекта 0.0–1.0
float GridSize     : register(c2);    // размер сетки (рекомендую 30–60)
float ScanlineSpeed: register(c3);    // скорость сканлайнов

sampler2D implicitInputSampler : register(s0);

float4 main(float2 uv : TEXCOORD) : COLOR
{
    float4 color = tex2D(implicitInputSampler, uv);

    color.rgb *= (1.0 - Intensity * 0.65);

    float scanline = sin(uv.y * 800 + Time * ScanlineSpeed * 10) * 0.5 + 0.5;
    scanline = pow(scanline, 8) * 0.3;
    color.rgb += float3(0.0, 0.8, 0.6) * scanline * Intensity;

    float2 grid = abs(frac(uv * GridSize) - 0.5) * 2.0;
    float gridLine = 1.0 - min(grid.x, grid.y);
    gridLine = saturate(gridLine * 40.0);
    color.rgb += float3(0.0, 1.0, 0.8) * gridLine * 0.15 * Intensity;

    float2 dist = uv - 0.5;
    float vignette = 1.0 - dot(dist, dist) * 0.8;
    color.rgb *= vignette;

    float glow = sin(Time * 3.0 + uv.x * 10.0) * 0.02 + 0.98;
    color.rgb *= glow;

    return color;
}